// Check if Web Pub Sub has private endpoints enabled
resources
| where type =~ 'Microsoft.SignalRService/webPubSub'
| extend privateEndpoints = array_length(properties.privateEndpointConnections)
| where privateEndpoints == 0 or isnull(privateEndpoints)
| extend recommendationId = 'wps-004'
| extend param1 = ''
| project recommendationId, name, id, tags, param1
