// Azure Resource Graph Query
// Find Application Gateways and report SLA based on zone redundancy or autoscale
resources
| where type =~ 'Microsoft.Network/applicationGateways'
| extend zones = properties.zones
| extend autoscaleEnabled = isnotnull(properties.autoscaleConfiguration)
| extend hasZones = array_length(zones) >= 2
| extend slaValue = case(
    hasZones or autoscaleEnabled, "99.95%",
    "No SLA"
)
| project recommendationId = 'agw-103', name, id, tags, param1 = slaValue
