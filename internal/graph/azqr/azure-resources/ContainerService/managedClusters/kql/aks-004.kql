// AKS Cluster should be private
resources
| where type =~ 'Microsoft.ContainerService/managedClusters'
| extend enablePrivateCluster = properties.apiServerAccessProfile.enablePrivateCluster
| where isnull(enablePrivateCluster) or enablePrivateCluster == false
| extend recommendationId = 'aks-004'
| extend param1 = 'Public cluster'
| project recommendationId, name, id, tags, param1
