// Check if Cognitive Services has private endpoints enabled
resources
| where type =~ 'Microsoft.CognitiveServices/accounts'
| extend privateEndpoints = array_length(properties.privateEndpointConnections)
| where privateEndpoints == 0 or isnull(privateEndpoints)
| extend recommendationId = 'aif-004'
| extend param1 = ''
| project recommendationId, name, id, tags, param1
