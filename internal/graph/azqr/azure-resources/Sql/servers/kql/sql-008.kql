// Azure Resource Graph Query
// Find SQL servers that don't enforce TLS 1.2 or higher
resources
| where type =~ "Microsoft.Sql/servers"
| where properties.minimalTlsVersion != "1.2"
| project recommendationId = "sql-008", name, id, tags, param1 = strcat("Current TLS version: ", tostring(properties.minimalTlsVersion))
