// Azure Resource Graph Query
// Find Synapse Workspaces that don't have private endpoints enabled
resources
| where type =~ "Microsoft.Synapse/workspaces"
| extend privateEndpoints = array_length(properties.privateEndpointConnections)
| where privateEndpoints == 0 or isnull(privateEndpoints)
| project recommendationId = "synw-002", name, id, tags, param1 = "No private endpoints configured"
