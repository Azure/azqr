// Check if CosmosDB has private endpoints enabled
resources
| where type =~ 'Microsoft.DocumentDB/databaseAccounts'
| extend privateEndpoints = array_length(properties.privateEndpointConnections)
| where privateEndpoints == 0 or isnull(privateEndpoints)
| extend recommendationId = 'cosmos-004'
| extend param1 = ''
| project recommendationId, name, id, tags, param1
