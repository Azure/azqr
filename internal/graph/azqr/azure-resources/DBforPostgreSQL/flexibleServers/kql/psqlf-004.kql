// Check if PostgreSQL Flexible Server has private access enabled
resources
| where type =~ 'Microsoft.DBforPostgreSQL/flexibleServers'
| extend publicNetworkAccess = properties.network.publicNetworkAccess
| where isnull(publicNetworkAccess) or publicNetworkAccess != 'Disabled'
| extend recommendationId = 'psqlf-004'
| extend param1 = ''
| project recommendationId, name, id, tags, param1
