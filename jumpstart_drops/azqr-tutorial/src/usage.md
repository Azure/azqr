# Usage of Azure Quick Review

## Running Azure Quick Review

After installing Azure Quick Review, you can start using it to scan your Azure resources. Here are the basic commands to run scans:

### Authentication

Before running the scan, you need to authenticate with Azure. You can use one of the following methods:

1. **Service Principal**: Set the following environment variables:
   - `AZURE_CLIENT_ID`
   - `AZURE_CLIENT_SECRET`
   - `AZURE_TENANT_ID`

2. **Azure Managed Identity**: If running in an Azure environment that supports managed identities.

3. **Azure CLI**: Ensure you are logged in using the Azure CLI by running:

    ```bash
    az login
    ```

### Scan All Resources

To scan all resources in all subscriptions, use the following command:

```bash
./azqr scan
```

### Scan Specific Management Group

To scan all resources in a specific management group, run:

```bash
./azqr scan --management-group-id <management_group_id>
```

### Scan Specific Subscription

To scan all resources in a specific subscription, execute:

```bash
./azqr scan -s <subscription_id>
```

### Scan Specific Resource Group

To scan a specific resource group within a subscription, use:

```bash
./azqr scan -s <subscription_id> -g <resource_group_name>
```

## Filtering Recommendations

You can customize your scans by filtering specific subscriptions, resource groups, services, or recommendations. To do this, create a YAML file with the following structure:

```yaml
azqr:
  include:
    subscriptions:
      - <subscription_id>
    resourceGroups:
      - <resource_group_resource_id>
    resourceTypes:
      - <resource type abbreviation>
  exclude:
    subscriptions:
      - <subscription_id>
    resourceGroups:
      - <resource_group_resource_id>
    services:
      - <service_resource_id>
    recommendations:
      - <recommendation_id>
```

### Running Scan with Filters

Once you have your YAML file ready, run the scan with the `--filters` flag:

```bash
./azqr scan --filters <path_to_yaml_file>
```

## Interpreting the Output

The output generated by Azure Quick Review is saved by default in an Excel file. The output includes several sheets:

- **Recommendations**: Lists all recommendations and the number of impacted resources.
- **ImpactedResources**: Details all resources that are impacted.
- **ResourceTypes**: Lists the types of impacted resources.
- **Inventory**: Provides details of all scanned resources, including SKU, Tier, and calculated SLA.
- **Advisor**: Contains recommendations from Azure Advisor.
- **DefenderRecommendations**: Lists recommendations from Microsoft Defender for Cloud.
- **OutOfScope**: Details resources that were not scanned.
- **Defender**: Lists Microsoft Defender for Cloud plans and their tiers.
- **Costs**: Shows costs associated with the scanned subscription for the last three months.

## Additional Help

For more information on available commands and help, run:

```bash
./azqr -h
```

This command will provide you with a list of all available options and their descriptions.
